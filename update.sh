#!/bin/bash

REPO_DIR="/root"  # –ü–∞–ø–∫–∞, –≥–¥–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

echo "üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ Telegram-–±–æ—Ç–∞..."

cd "$REPO_DIR" || exit 1

# –°–æ—Ö—Ä–∞–Ω—è–µ–º .env, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
if [ -f .env ]; then
    cp .env .env.bak
    echo "‚úÖ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è .env —Å–æ–∑–¥–∞–Ω–∞"
fi

# –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git pull origin main || {
    echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏–∑ Git"
    exit 1
}

# –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º .env, –µ—Å–ª–∏ –±—ã–ª –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω
if [ -f .env.bak ]; then
    mv .env.bak .env
    echo "‚úÖ .env –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
fi

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–∏—Å
echo "üîÅ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ systemd-—Å–µ—Ä–≤–∏—Å–∞..."
systemctl restart vpnbot.service

echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ"
